also contains code for Suppl. Figures 12-13